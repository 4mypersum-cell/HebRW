<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hebrew Learning App - ××¢×¨×›×ª ×œ×™××•×“ ×¢×‘×¨×™×ª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', 'Heebo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            font-size: 3em;
            margin-bottom: 10px;
        }
        
        h2 {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        
        .input-section {
            margin: 30px 0;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            border: 2px solid #667eea;
            border-radius: 10px;
            text-align: center;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 30px 0;
            padding: 20px;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 15px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-card .number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-card .label {
            color: #666;
            margin-top: 5px;
        }
        
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .menu-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border: none;
            border-radius: 15px;
            font-size: 1.3em;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .menu-button:hover {
            transform: scale(1.05);
        }
        
        .letter-display {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 20px;
            margin: 20px 0;
        }
        
        .letter-big {
            font-size: 10em;
            color: white;
            font-weight: bold;
        }
        
        .letter-name {
            font-size: 2.5em;
            color: white;
            margin: 20px 0;
        }
        
        .speaker-btn {
            background: white;
            border: none;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            font-size: 2em;
            cursor: pointer;
            margin: 20px auto;
            display: block;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }
        
        .speaker-btn:hover {
            transform: scale(1.1);
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        button {
            padding: 15px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5568d3;
        }
        
        .btn-secondary {
            background: #ddd;
            color: #333;
        }
        
        .btn-secondary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .exercise-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            padding: 30px;
            background: #f5f5f5;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .letter-btn {
            font-size: 3em;
            padding: 15px;
            border: 3px solid #ddd;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            min-width: 80px;
            transition: all 0.3s;
        }
        
        .letter-btn:hover:not(:disabled) {
            transform: scale(1.1);
        }
        
        .letter-btn.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .letter-btn.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }
        
        .letter-btn.wrong {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }
        
        .letter-btn.missed {
            background: #ff9800;
            color: white;
            border-color: #ff9800;
        }
        
        .info-box {
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        
        .info-box.success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        
        .info-box.warning {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffeeba;
        }
        
        .hidden {
            display: none;
        }
        
        .back-btn {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // × ×ª×•× ×™×
        const hebrewAlphabet = [
            { letter: '×', name: '×Ö¸×œÖ¶×£', sound: 'alef' },
            { letter: '×‘', name: '×‘ÖµÖ¼×™×ª', sound: 'bet' },
            { letter: '×’', name: '×’Ö´Ö¼×™×Ö¶×œ', sound: 'gimel' },
            { letter: '×“', name: '×“Ö¸Ö¼×œÖ¶×ª', sound: 'dalet' },
            { letter: '×”', name: '×”Öµ×', sound: 'heh' },
            { letter: '×•', name: '×•Ö¸×•', sound: 'vav' },
            { letter: '×–', name: '×–Ö·×™Ö´×Ÿ', sound: 'zayin' },
            { letter: '×—', name: '×—Öµ×™×ª', sound: 'chet' },
            { letter: '×˜', name: '×˜Öµ×™×ª', sound: 'tet' },
            { letter: '×™', name: '×™×•Ö¹×“', sound: 'yod' },
            { letter: '×›', name: '×›Ö·Ö¼×£', sound: 'kaf' },
            { letter: '×œ', name: '×œÖ¸×Ö¶×“', sound: 'lamed' },
            { letter: '×', name: '×Öµ×', sound: 'mem' },
            { letter: '× ', name: '× ×•Ö¼×Ÿ', sound: 'nun' },
            { letter: '×¡', name: '×¡Ö¸×Ö¶×šÖ°', sound: 'samech' },
            { letter: '×¢', name: '×¢Ö·×™Ö´×Ÿ', sound: 'ayin' },
            { letter: '×¤', name: '×¤ÖµÖ¼×', sound: 'peh' },
            { letter: '×¦', name: '×¦Ö¸×“Ö´×™', sound: 'tzadi' },
            { letter: '×§', name: '×§×•Ö¹×£', sound: 'kof' },
            { letter: '×¨', name: '×¨Öµ×™×©×', sound: 'resh' },
            { letter: '×©', name: '×©Ö´××™×Ÿ', sound: 'shin' },
            { letter: '×ª', name: '×ªÖ¸Ö¼×•', sound: 'tav' }
        ];

        const words = [
            { word: '×©Ö¸××œ×•Ö¹×', translation: 'hello/peace' },
            { word: '×ªÖ¼×•Ö¹×“Ö¸×”', translation: 'thank you' },
            { word: '×‘Ö·Ö¼×™Ö´×ª', translation: 'house' },
            { word: '×Ö¸×‘', translation: 'father' },
            { word: '×Öµ×', translation: 'mother' },
            { word: '×™Ö¶×œÖ¶×“', translation: 'boy/child' },
            { word: '×™Ö·×œÖ°×“Ö¸Ö¼×”', translation: 'girl' },
            { word: '×Ö·×™Ö´×', translation: 'water' },
            { word: '×Ö²× Ö´×™ ×¨×•Ö¹×¦Ö¶×”', translation: 'I want (male)' },
            { word: '×Ö²× Ö´×™ ×¨×•Ö¹×¦Ö¸×”', translation: 'I want (female)' },
            { word: '×Ö´×Ö¼Ö¸× ×”×•Ö¹×œÖ¶×›Ö¶×ª ×œÖ·×’Ö¼Ö·×Ÿ', translation: 'Mom is going to the garden' },
            { word: '×Ö·×‘Ö¼Ö¸× ×‘Ö¼Ö¸×Ö¸×” ×”Ö·×‘Ö¼Ö·×™Ö°×ªÖ¸×”', translation: 'Dad is coming home' },
            { word: '×”×•Ö¼× ×—×•Ö¹×©×Öµ×‘', translation: 'He is thinking' },
            { word: '×”Ö´×™× ×—×•Ö¹×©×Ö¶×‘Ö¶×ª', translation: 'She is thinking' },
            { word: '×™Ö·×œÖ°×“Ö¼Ö¸×” ×¨×•Ö¹×¦Ö¸×” ×œÖ´×©×Ö°×ªÖ¼×•Ö¹×ª ×Ö·×™Ö´×', translation: 'The girl wants to drink water' },
            { word: '×™Ö¸×œÖ·×“ ×Ö°×“Ö·×‘ÖµÖ¼×¨ ×¢Ö´×‘Ö°×¨Ö´×™×ª', translation: 'The boy is speaking Hebrew' },
            { word: '×Ö·×ªÖ°Ö¼ ×Ö°×“Ö·×‘Ö¶Ö¼×¨Ö¶×ª ×¢Ö´×‘Ö°×¨Ö´×™×ª?', translation: 'Do you speak Hebrew? (female)' },
            { word: '×Ö·×ªÖ¸Ö¼×” ×Ö°×“Ö·×‘ÖµÖ¼×¨ ×¢Ö´×‘Ö°×¨Ö´×™×ª?', translation: 'Do you speak Hebrew? (male)' },
            { word: '×Ö²× Ö´×™ ×¨×•Ö¹×¦Ö¶×” ×œÖ´×©Ö°××Ö¹×œ', translation: 'I want to ask (male)' }
        ];

        // ×˜×§×¡×˜×™× ×œ×ª×¨×’×•×œ
        const practiceTexts = [
            "×©×œ×•× ×œ×›×•×œ× ×”×™×•× ×™×•× ×™×¤×” ×‘×—×•×¥ ×™×© ×©××© ×•×”×©××™×™× ×›×—×•×œ×™× ×× ×™ ×©××— ×××•×“",
            "××× ×•××‘× ×”×•×œ×›×™× ×œ×©×•×§ ×œ×§× ×•×ª ×™×¨×§×•×ª ×•×¤×™×¨×•×ª ×˜×¨×™×™× ×œ××¨×•×—×ª ×”×¢×¨×‘",
            "×”×™×œ×“×™× ××©×—×§×™× ×‘×’×Ÿ ×¢× ×”×—×‘×¨×™× ×©×œ×”× ×›×“×•×¨ ×•××©×—×§×™× ××”× ×™×",
            "×‘×‘×™×ª ×©×œ× ×• ×™×© ×—×ª×•×œ ×§×˜×Ÿ ×•×©×—×•×¨ ×”×•× ××•×”×‘ ×œ×™×©×•×Ÿ ×¢×œ ×”×¡×¤×”",
            "×‘×‘×•×§×¨ ×× ×™ ×§× ××•×§×“× ×©×•×ª×” ××™× ×•××•×›×œ ××¨×•×—×ª ×‘×•×§×¨ ×‘×¨×™××”",
            "×”×™× ×›×—×•×œ ×•×”×’×œ×™× ×’×‘×•×”×™× ×™×œ×“×™× ×‘×•× ×™× ××¨××•×Ÿ ×—×•×œ ×¢×œ ×”×—×•×£",
            "×‘×’×Ÿ ×™×© ×¢×¦×™× ×¨×‘×™× ×¤×¨×—×™× ×¦×‘×¢×•× ×™×™× ×•×¦×™×¤×•×¨×™× ×©×¨×•×ª ×©×™×¨×™× ×™×¤×™×"
        ];

        // State
        let state = {
            screen: 'home',
            userName: '',
            points: 0,
            level: 1,
            streak: 1,
            minutes: 0,
            currentLetterIndex: 0,
            currentWordIndex: 0,
            masteredLetters: [],
            showExercise: false,
            showTextExercise: false,
            selectedLetters: [],
            exerciseLetters: [],
            exerciseComplete: false,
            textExerciseText: '',
            textExerciseWords: [],
            selectedTextIndices: []
        };

        // ×¤×•× ×§×¦×™×•×ª ×¢×–×¨
        function speak(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                
                // Get all available voices
                const voices = window.speechSynthesis.getVoices();
                
                // Find Hebrew voice
                let hebrewVoice = voices.find(voice => 
                    voice.lang.startsWith('he') || 
                    voice.lang.includes('Hebrew') ||
                    voice.name.includes('Hebrew')
                );
                
                // If no Hebrew voice, try to find any available voice
                if (!hebrewVoice && voices.length > 0) {
                    hebrewVoice = voices[0]; // Use first available voice
                }
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'he-IL';
                utterance.rate = 0.8;
                utterance.pitch = 1.0;
                utterance.volume = 1.0;
                
                if (hebrewVoice) {
                    utterance.voice = hebrewVoice;
                    console.log('Speaking with voice:', hebrewVoice.name, hebrewVoice.lang);
                } else {
                    console.warn('No voices available');
                }
                
                // Handle errors and events
                utterance.onerror = function(event) {
                    console.error('Speech error:', event.error);
                };
                
                utterance.onstart = function() {
                    console.log('Speech started');
                };
                
                utterance.onend = function() {
                    console.log('Speech ended');
                };
                
                try {
                    window.speechSynthesis.speak(utterance);
                } catch (error) {
                    console.error('Failed to speak:', error);
                }
            } else {
                console.log('Speech synthesis not supported');
                alert('Text-to-speech is not supported in this browser. Please use Chrome, Edge, or Firefox.');
            }
        }
        
        // Load voices when they become available
        if ('speechSynthesis' in window) {
            // Try to get voices immediately
            const voices = window.speechSynthesis.getVoices();
            if (voices.length === 0) {
                // Wait for voices to load
                window.speechSynthesis.onvoiceschanged = function() {
                    console.log('Voices loaded:', window.speechSynthesis.getVoices().length);
                };
            }
        }

        function addPoints(points) {
            state.points += points;
            state.level = Math.floor(state.points / 100) + 1;
            render();
        }

        function generateExercise() {
            const letters = [];
            const targetLetter = hebrewAlphabet[state.currentLetterIndex].letter;
            
            for (let i = 0; i < 6; i++) {
                letters.push({ letter: targetLetter, isTarget: true, id: 'target-' + i });
            }
            
            for (let i = 0; i < 12; i++) {
                const randomLetter = hebrewAlphabet[Math.floor(Math.random() * hebrewAlphabet.length)].letter;
                if (randomLetter !== targetLetter) {
                    letters.push({ letter: randomLetter, isTarget: false, id: 'other-' + i });
                }
            }
            
            return letters.sort(() => Math.random() - 0.5);
        }

        function generateTextExercise() {
            const targetLetter = hebrewAlphabet[state.currentLetterIndex].letter;
            const text = practiceTexts[Math.floor(Math.random() * practiceTexts.length)];
            
            const words = text.split(' ');
            const wordsData = [];
            
            words.forEach((word, wordIndex) => {
                const letters = word.split('');
                const lettersData = letters.map((letter, letterIndex) => ({
                    letter: letter,
                    isTarget: letter === targetLetter,
                    id: `word-${wordIndex}-letter-${letterIndex}`
                }));
                wordsData.push(lettersData);
            });
            
            return { text, words: wordsData };
        }

        // ×¨×™× ×“×•×¨ ×”××¡×›×™×
        function renderHome() {
            return `
                <div class="container">
                    <h1>ğŸ“š ×œ×œ××•×“ ×¢×‘×¨×™×ª!</h1>
                    <h2>Learn Hebrew Reading & Writing</h2>
                    
                    ${!state.userName ? `
                        <div class="input-section">
                            <input type="text" id="nameInput" placeholder="××” ×©××š? What's your name?" />
                            <button class="btn-primary" style="width: 100%; margin-top: 15px;" onclick="setName()">×”×ª×—×œ Start</button>
                        </div>
                    ` : `
                        <div class="stats">
                            <div class="stat-card">
                                <div class="number">${state.points}</div>
                                <div class="label">× ×§×•×“×•×ª Points</div>
                            </div>
                            <div class="stat-card">
                                <div class="number">${state.level}</div>
                                <div class="label">×¨××” Level</div>
                            </div>
                            <div class="stat-card">
                                <div class="number">${state.streak}</div>
                                <div class="label">×™××™× Days</div>
                            </div>
                            <div class="stat-card">
                                <div class="number">${state.minutes}</div>
                                <div class="label">×“×§×•×ª Minutes</div>
                            </div>
                        </div>
                        
                        <h3 style="text-align: center; margin: 20px 0;">×©×œ×•× ${state.userName}! ğŸ‘‹</h3>
                        
                        <div class="menu-grid">
                            <button class="menu-button" onclick="goToScreen('alphabet')">
                                ğŸ“š ×œ×™××•×“ ××•×ª×™×•×ª<br>Learn Letters
                            </button>
                            <button class="menu-button" onclick="goToScreen('words')">
                                ğŸ“– ×ª×¨×’×•×œ ××™×œ×™×<br>Practice Words
                            </button>
                        </div>
                    `}
                </div>
            `;
        }

        function renderAlphabet() {
            const letter = hebrewAlphabet[state.currentLetterIndex];
            
            // ×ª×¨×’×™×œ ×˜×§×¡×˜
            if (state.showTextExercise) {
                const targetCount = state.textExerciseWords.flat().filter(l => l.isTarget).length;
                const found = state.textExerciseWords.flat().filter(l => l.isTarget && state.selectedTextIndices.includes(l.id)).length;
                
                return `
                    <div class="container">
                        <button class="btn-secondary back-btn" onclick="backToLetter()">â† ×—×–×¨×” Back</button>
                        
                        <h2>ğŸ“– ××¦× ××ª ×”××•×ª ×‘×˜×§×¡×˜ Find the Letter in Text</h2>
                        <div class="letter-display">
                            <div class="letter-big">${letter.letter}</div>
                            <button class="speaker-btn" onclick="speak('${letter.name}')">ğŸ”Š</button>
                        </div>
                        
                        <div class="info-box warning">
                            <strong>× ××¦××• Found: ${found} / ${targetCount}</strong>
                            <p style="margin-top: 10px;">×œ×—×¥ ×¢×œ ×›×œ ×”××•×ª×™×•×ª <span style="font-size: 1.5em; color: #667eea;">${letter.letter}</span> ×‘×˜×§×¡×˜!</p>
                        </div>
                        
                        <div style="background: #f5f5f5; padding: 30px; border-radius: 15px; margin: 20px 0; line-height: 2.5; font-size: 1.8em; text-align: right; direction: rtl;">
                            ${state.textExerciseWords.map((word, wordIndex) => `
                                <span style="display: inline-block; margin: 0 5px;">
                                    ${word.map(letterObj => `
                                        <span 
                                            onclick="toggleTextLetter('${letterObj.id}')" 
                                            style="
                                                cursor: pointer; 
                                                padding: 5px 8px; 
                                                margin: 0 2px;
                                                border-radius: 5px;
                                                display: inline-block;
                                                transition: all 0.3s;
                                                ${state.exerciseComplete ? 
                                                    (letterObj.isTarget && state.selectedTextIndices.includes(letterObj.id) ? 
                                                        'background: #4caf50; color: white;' :
                                                     letterObj.isTarget && !state.selectedTextIndices.includes(letterObj.id) ? 
                                                        'background: #ff9800; color: white;' :
                                                     !letterObj.isTarget && state.selectedTextIndices.includes(letterObj.id) ? 
                                                        'background: #f44336; color: white;' : 
                                                        '') :
                                                    (state.selectedTextIndices.includes(letterObj.id) ? 
                                                        'background: #667eea; color: white;' : 
                                                        'background: white;')
                                                }
                                                ${state.exerciseComplete ? 'pointer-events: none;' : ''}
                                            ">
                                            ${letterObj.letter}
                                        </span>
                                    `).join('')}
                                </span>
                            `).join(' ')}
                        </div>
                        
                        ${state.exerciseComplete ? `
                            <div class="info-box success">
                                <h3>âœ… ×”×¡×ª×™×™×! Complete!</h3>
                                <p>ğŸŸ¢ ×™×¨×•×§ = × ×›×•×Ÿ | ğŸŸ  ×›×ª×•× = ×¤×¡×¤×¡×ª | ğŸ”´ ××“×•× = ×˜×¢×•×ª</p>
                            </div>
                            <div class="navigation">
                                <button class="btn-secondary" onclick="startTextExercise()">ğŸ”„ ×˜×§×¡×˜ ×—×“×© New Text</button>
                                <button class="btn-primary" onclick="nextLetter()">â¡ï¸ ××•×ª ×”×‘××” Next</button>
                            </div>
                        ` : `
                            <div class="navigation">
                                <button class="btn-secondary" onclick="clearTextSelection()">ğŸ—‘ï¸ × ×§×” Clear</button>
                                <button class="btn-primary" onclick="checkTextExercise()">âœ“ ×‘×“×•×§ Check</button>
                            </div>
                        `}
                    </div>
                `;
            }
            
            // ×ª×¨×’×™×œ ×–×™×”×•×™ ××•×ª×™×•×ª
            if (state.showExercise) {
                const targetCount = state.exerciseLetters.filter(l => l.isTarget).length;
                const found = state.exerciseLetters.filter(l => l.isTarget && state.selectedLetters.includes(l.id)).length;
                
                return `
                    <div class="container">
                        <button class="btn-secondary back-btn" onclick="backToLetter()">â† ×—×–×¨×” Back</button>
                        
                        <h2>ğŸ¯ ××¦× ××ª ×”××•×ª Find the Letter</h2>
                        <div class="letter-display">
                            <div class="letter-big">${letter.letter}</div>
                        </div>
                        
                        <div class="info-box warning">
                            <strong>× ××¦××• Found: ${found} / ${targetCount}</strong>
                        </div>
                        
                        <div class="exercise-grid">
                            ${state.exerciseLetters.map(l => `
                                <button class="letter-btn ${getLetterClass(l)}" 
                                onclick="toggleLetter('${l.id}')" 
                                ${state.exerciseComplete ? 'disabled' : ''}>
                                    ${l.letter}
                                </button>
                            `).join('')}
                        </div>
                        
                        ${state.exerciseComplete ? `
                            <div class="info-box success">
                                <h3>âœ… ×”×¡×ª×™×™×! Complete!</h3>
                                <p>ğŸŸ¢ ×™×¨×•×§ = × ×›×•×Ÿ | ğŸŸ  ×›×ª×•× = ×¤×¡×¤×¡×ª | ğŸ”´ ××“×•× = ×˜×¢×•×ª</p>
                            </div>
                            <div class="navigation">
                                <button class="btn-secondary" onclick="startExercise()">ğŸ”„ × ×¡×” ×©×•×‘ Try Again</button>
                                <button class="btn-primary" onclick="nextLetter()">â¡ï¸ ××•×ª ×”×‘××” Next</button>
                            </div>
                        ` : `
                            <div class="navigation">
                                <button class="btn-secondary" onclick="clearSelection()">ğŸ—‘ï¸ × ×§×” Clear</button>
                                <button class="btn-primary" onclick="checkExercise()">âœ“ ×‘×“×•×§ Check</button>
                            </div>
                        `}
                    </div>
                `;
            }
            
            return `
                <div class="container">
                    <button class="btn-secondary back-btn" onclick="goToScreen('home')">â† ×—×–×¨×” Home</button>
                    
                    <h2>×œ×™××•×“ ××•×ª×™×•×ª Learn Letters</h2>
                    <p style="text-align: center; color: #666;">××•×ª ${state.currentLetterIndex + 1} ××ª×•×š ${hebrewAlphabet.length}</p>
                    
                    <div class="letter-display">
                        <div class="letter-big">${letter.letter}</div>
                        <button class="speaker-btn" onclick="speak('${letter.name}')" title="Click to hear pronunciation">ğŸ”Š</button>
                        <div class="letter-name">${letter.name}</div>
                        <div style="color: white; font-size: 1.5em;">${letter.sound}</div>
                    </div>
                    
                    <div class="info-box warning">
                        <h3>ğŸ¯ ××•×›×Ÿ ×œ×ª×¨×’×™×œ? Ready to Practice?</h3>
                        <p>×‘×“×•×§ ×× ××ª×” ×™×›×•×œ ×œ×–×”×•×ª ××ª ×”××•×ª ×”×–××ª!</p>
                        <button class="btn-primary" style="margin-top: 10px; margin-right: 10px;" onclick="startExercise()">ğŸ® ×ª×¨×’×™×œ ×–×™×”×•×™ Exercise 1</button>
                        <button class="btn-primary" style="margin-top: 10px;" onclick="startTextExercise()">ğŸ“– ××¦× ×‘×˜×§×¡×˜ Exercise 2</button>
                    </div>
                    
                    <div class="navigation">
                        <button class="btn-secondary" onclick="prevLetter()" ${state.currentLetterIndex === 0 ? 'disabled' : ''}>â† ×§×•×“× Previous</button>
                        <button class="btn-primary" onclick="nextLetter()">
                            ${state.currentLetterIndex === hebrewAlphabet.length - 1 ? 'âœ“ ×¡×™×™× Finish' : '×”×‘× Next â†’'}
                        </button>
                    </div>
                    
                    <div class="info-box success">
                        <strong>ğŸŒŸ +10 × ×§×•×“×•×ª ×¢×œ ××•×ª | +25 ×¢×œ ×ª×¨×’×™×œ 1 ××•×©×œ× | +30 ×¢×œ ×ª×¨×’×™×œ 2 ××•×©×œ×!</strong>
                    </div>
                    
                    <div class="info-box warning" style="margin-top: 20px;">
                        <strong>ğŸ”Š ×œ× ×©×•××¢×™× ×§×•×œ? No Sound?</strong><br>
                        <small>×¤×ª×—×• ××ª Console (F12) ×œ×¨××•×ª ××™×œ×• ×§×•×œ×•×ª ×–××™× ×™× | Open Console (F12) to see available voices</small><br>
                        <small>×× ××™×Ÿ ×§×•×œ ×¢×‘×¨×™, ×”×•×¨×™×“×•: Windows Settings â†’ Time & Language â†’ Speech â†’ Add voices</small><br>
                        <small>If no Hebrew voice, download: Windows Settings â†’ Time & Language â†’ Speech â†’ Add voices</small>
                    </div>
                </div>
            `;
        }

        function renderWords() {
            const word = words[state.currentWordIndex];
            
            return `
                <div class="container">
                    <button class="btn-secondary back-btn" onclick="goToScreen('home')">â† ×—×–×¨×” Home</button>
                    
                    <h2>×ª×¨×’×•×œ ××™×œ×™× Practice Words</h2>
                    <p style="text-align: center; color: #666;">××™×œ×” ${state.currentWordIndex + 1} ××ª×•×š ${words.length}</p>
                    
                    <div class="letter-display">
                        <div class="letter-big" style="font-size: 5em;">${word.word}</div>
                        <button class="speaker-btn" onclick="speak('${word.word}')">ğŸ”Š</button>
                        <div class="letter-name" style="font-size: 2em;">${word.translation}</div>
                    </div>
                    
                    <div class="info-box warning">
                        ğŸ’¡ <strong>×˜×™×¤:</strong> ×¢×‘×¨×™×ª × ×§×¨××ª ××™××™×Ÿ ×œ×©×××œ â† 
                    </div>
                    
                    <div class="navigation">
                        <button class="btn-secondary" onclick="prevWord()" ${state.currentWordIndex === 0 ? 'disabled' : ''}>â† ×§×•×“× Previous</button>
                        <button class="btn-primary" onclick="nextWord()">
                            ${state.currentWordIndex === words.length - 1 ? 'âœ“ ×¡×™×™× Finish' : '×”×‘× Next â†’'}
                        </button>
                    </div>
                    
                    <div class="info-box success">
                        <strong>ğŸŒŸ +15 × ×§×•×“×•×ª ×¢×œ ××™×œ×”!</strong>
                    </div>
                </div>
            `;
        }

        // ×¤×•× ×§×¦×™×•×ª ××™×¨×•×¢×™×
        function setName() {
            const input = document.getElementById('nameInput');
            if (input && input.value.trim()) {
                state.userName = input.value.trim();
                render();
            }
        }

        function goToScreen(screen) {
            state.screen = screen;
            render();
        }

        function nextLetter() {
            if (state.currentLetterIndex < hebrewAlphabet.length - 1) {
                state.currentLetterIndex++;
                state.showExercise = false;
                state.showTextExercise = false;
                state.exerciseComplete = false;
                state.selectedLetters = [];
                state.selectedTextIndices = [];
                addPoints(10);
            } else {
                goToScreen('home');
            }
        }

        function prevLetter() {
            if (state.currentLetterIndex > 0) {
                state.currentLetterIndex--;
                state.showExercise = false;
                state.showTextExercise = false;
                state.exerciseComplete = false;
                state.selectedLetters = [];
                state.selectedTextIndices = [];
                render();
            }
        }

        function nextWord() {
            if (state.currentWordIndex < words.length - 1) {
                state.currentWordIndex++;
                addPoints(15);
            } else {
                goToScreen('home');
            }
        }

        function prevWord() {
            if (state.currentWordIndex > 0) {
                state.currentWordIndex--;
                render();
            }
        }

        function startExercise() {
            state.showExercise = true;
            state.showTextExercise = false;
            state.selectedLetters = [];
            state.exerciseComplete = false;
            state.exerciseLetters = generateExercise();
            render();
        }

        function startTextExercise() {
            state.showTextExercise = true;
            state.showExercise = false;
            state.selectedTextIndices = [];
            state.exerciseComplete = false;
            const textData = generateTextExercise();
            state.textExerciseText = textData.text;
            state.textExerciseWords = textData.words;
            render();
        }

        function backToLetter() {
            state.showExercise = false;
            state.showTextExercise = false;
            render();
        }

        function toggleLetter(id) {
            if (state.exerciseComplete) return;
            
            const index = state.selectedLetters.indexOf(id);
            if (index > -1) {
                state.selectedLetters.splice(index, 1);
            } else {
                state.selectedLetters.push(id);
            }
            render();
        }

        function toggleTextLetter(id) {
            if (state.exerciseComplete) return;
            
            const index = state.selectedTextIndices.indexOf(id);
            if (index > -1) {
                state.selectedTextIndices.splice(index, 1);
            } else {
                state.selectedTextIndices.push(id);
            }
            render();
        }

        function clearSelection() {
            state.selectedLetters = [];
            render();
        }

        function clearTextSelection() {
            state.selectedTextIndices = [];
            render();
        }

        function checkExercise() {
            state.exerciseComplete = true;
            const correctIds = state.exerciseLetters.filter(l => l.isTarget).map(l => l.id);
            const isCorrect = correctIds.length === state.selectedLetters.length && 
                             correctIds.every(id => state.selectedLetters.includes(id));
            
            if (isCorrect) {
                addPoints(25);
            }
            render();
        }

        function checkTextExercise() {
            state.exerciseComplete = true;
            const correctIds = state.textExerciseWords.flat().filter(l => l.isTarget).map(l => l.id);
            const isCorrect = correctIds.length === state.selectedTextIndices.length && 
                             correctIds.every(id => state.selectedTextIndices.includes(id));
            
            if (isCorrect) {
                addPoints(30);
            }
            render();
        }

        function getLetterClass(letterObj) {
            if (!state.exerciseComplete) {
                return state.selectedLetters.includes(letterObj.id) ? 'selected' : '';
            } else {
                if (letterObj.isTarget && state.selectedLetters.includes(letterObj.id)) {
                    return 'correct';
                } else if (letterObj.isTarget && !state.selectedLetters.includes(letterObj.id)) {
                    return 'missed';
                } else if (!letterObj.isTarget && state.selectedLetters.includes(letterObj.id)) {
                    return 'wrong';
                }
                return '';
            }
        }

        function render() {
            const app = document.getElementById('app');
            
            switch(state.screen) {
                case 'home':
                    app.innerHTML = renderHome();
                    break;
                case 'alphabet':
                    app.innerHTML = renderAlphabet();
                    break;
                case 'words':
                    app.innerHTML = renderWords();
                    break;
            }
        }

        // ×”×ª×—×œ×”
        // Force load voices on page load
        if ('speechSynthesis' in window) {
            // Trigger voice loading immediately
            setTimeout(() => {
                const voices = window.speechSynthesis.getVoices();
                console.log('Available voices:', voices.length);
                const hebrewVoices = voices.filter(v => v.lang.startsWith('he'));
                console.log('Hebrew voices:', hebrewVoices.length, hebrewVoices.map(v => v.name));
                
                if (hebrewVoices.length > 0) {
                    console.log('Hebrew voice found:', hebrewVoices[0].name);
                } else {
                    console.warn('No Hebrew voice found. Text-to-speech may not work correctly.');
                    console.log('Available languages:', [...new Set(voices.map(v => v.lang))]);
                }
            }, 100);
        }
        
        render();
    </script>
</body>
</html>